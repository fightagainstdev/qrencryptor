(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{9344:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return r(2794)}])},2794:function(e,n,r){"use strict";r.r(n);var t=r(4051),a=r.n(t),s=r(5893),o=r(7294),i=r(1163),u=r(5876),c=r(9828),l=r(6689),p=r(20),d=r(2318),f=r(3832),m=r(9895),h=r(4198),v=r(7265),x=r(282),w=r(3426),g=r(7812),b=r(2822),j=r(998),y=r(5757),Z=r(2663),k=r(6083),C=r(9525),S=r(6856),I=r(5046),P=r(1120),O=r(8428),A=r(3957),N=r(9067),_=r(7239);function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function U(e,n,r,t,a,s,o){try{var i=e[s](o),u=i.value}catch(c){return void r(c)}i.done?n(u):Promise.resolve(u).then(t,a)}function B(e){return function(){var n=this,r=arguments;return new Promise((function(t,a){var s=e.apply(n,r);function o(e){U(s,t,a,o,i,"next",e)}function i(e){U(s,t,a,o,i,"throw",e)}o(void 0)}))}}function E(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function W(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){E(e,n,r[n])}))}return e}function T(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return F(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var J=(0,P.Z)((function(e){return{container:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:e.spacing(4)},paper:{padding:e.spacing(3),marginBottom:e.spacing(2),width:"100%",maxWidth:600},avatar:{width:e.spacing(10),height:e.spacing(10),marginBottom:e.spacing(2)},uploadButton:{marginTop:e.spacing(1)},vaultItem:{display:"flex",justifyContent:"space-between",alignItems:"center"}}}));n.default=function(){var e=J(),n=(0,i.useRouter)(),r=(0,o.useState)(null),t=r[0],P=r[1],F=(0,o.useState)({username:"",email:"",avatar:"",passwords:[]}),U=F[0],E=F[1],q=(0,o.useState)(!0),z=q[0],D=q[1],V=(0,o.useState)(""),M=V[0],X=V[1],K=(0,o.useState)(null),G=K[0],H=K[1],L=(0,o.useState)(""),Q=L[0],R=L[1],$=(0,o.useState)(""),Y=$[0],ee=$[1],ne=(0,o.useState)(!1),re=ne[0],te=ne[1],ae=(0,o.useState)(null),se=ae[0],oe=ae[1],ie=(0,o.useState)(""),ue=ie[0],ce=ie[1],le=(0,o.useState)(""),pe=le[0],de=le[1],fe=(0,o.useState)(!1),me=fe[0],he=fe[1];(0,o.useEffect)((function(){var e=(0,u.Aj)(p.I,function(){var e=B(a().mark((function e(r){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=8;break}return P(r),e.next=4,(0,c.QT)((0,c.JU)(p.db,"users",r.uid));case 4:(t=e.sent).exists()&&E(W({username:"",email:"",avatar:"",passwords:[]},t.data())),e.next=9;break;case 8:n.push("/login");case 9:D(!1);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());return function(){return e()}}),[n]);var ve=function(){var e=B(a().mark((function e(){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(G&&t){e.next=2;break}return e.abrupt("return");case 2:return n=(0,l.iH)(p.t,"avatars/".concat(t.uid)),e.prev=3,e.next=6,(0,l.KV)(n,G);case 6:return e.next=8,(0,l.Jt)(n);case 8:return r=e.sent,e.next=11,(0,c.r7)((0,c.JU)(p.db,"users",t.uid),{avatar:r});case 11:E(W({},U,{avatar:r})),H(null),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),X("Failed to upload avatar");case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=B(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Q&&Y&&!((U.passwords||[]).length>=5)){e.next=2;break}return e.abrupt("return");case 2:if(!(U.passwords||[]).map((function(e){return e.name})).includes(Q)){e.next=6;break}return X("Password name must be unique"),e.abrupt("return");case 6:return n=T(U.passwords||[]).concat([{name:Q,password:Y}]),e.prev=7,e.next=10,(0,c.r7)((0,c.JU)(p.db,"users",t.uid),{passwords:n});case 10:E(W({},U,{passwords:n})),R(""),ee(""),te(!1),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(7),X("Failed to add password");case 19:case"end":return e.stop()}}),e,null,[[7,16]])})));return function(){return e.apply(this,arguments)}}(),we=function(){var e=B(a().mark((function e(n){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(U.passwords||[]).filter((function(e,r){return r!==n})),e.prev=1,e.next=4,(0,c.r7)((0,c.JU)(p.db,"users",t.uid),{passwords:r});case 4:E(W({},U,{passwords:r})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),X("Failed to delete password");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(n){return e.apply(this,arguments)}}(),ge=function(){var e=B(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ue&&pe){e.next=2;break}return e.abrupt("return");case 2:if(!(U.passwords||[]).map((function(e,n){return n!==se?e.name:null})).filter(Boolean).includes(ue)){e.next=6;break}return X("Password name must be unique"),e.abrupt("return");case 6:return(n=T(U.passwords||[]))[se]={name:ue,password:pe},e.prev=8,e.next=11,(0,c.r7)((0,c.JU)(p.db,"users",t.uid),{passwords:n});case 11:E(W({},U,{passwords:n})),he(!1),oe(null),ce(""),de(""),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),X("Failed to update password");case 21:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=B(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.clipboard.writeText(n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),X("Failed to copy password");case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(n){return e.apply(this,arguments)}}();return z?(0,s.jsx)(d.Z,{children:"Loading..."}):t?(0,s.jsxs)(f.Z,{component:"main",maxWidth:"md",className:e.container,children:[(0,s.jsx)(d.Z,{component:"h1",variant:"h4",gutterBottom:!0,children:"User Profile"}),M&&(0,s.jsx)(I.Z,{severity:"error",children:M}),(0,s.jsxs)(m.Z,{className:e.paper,children:[(0,s.jsx)(d.Z,{variant:"h6",gutterBottom:!0,children:"Profile Information"}),(0,s.jsxs)(h.Z,{display:"flex",flexDirection:"column",alignItems:"center",children:[(0,s.jsx)(v.Z,{src:U.avatar,className:e.avatar}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){return H(e.target.files[0])},style:{display:"none"},id:"avatar-upload"}),(0,s.jsx)("label",{htmlFor:"avatar-upload",children:(0,s.jsx)(x.Z,{variant:"contained",component:"span",className:e.uploadButton,children:"Choose Avatar"})}),G&&(0,s.jsx)(x.Z,{onClick:ve,variant:"contained",color:"primary",children:"Upload Avatar"})]}),(0,s.jsx)(w.Z,{label:"Username",value:U.username,fullWidth:!0,margin:"normal",InputProps:{readOnly:!0}}),(0,s.jsx)(w.Z,{label:"Email",value:U.email,fullWidth:!0,margin:"normal",InputProps:{readOnly:!0}})]}),(0,s.jsxs)(m.Z,{className:e.paper,children:[(0,s.jsxs)(h.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(d.Z,{variant:"h6",children:["Password Vault (",(U.passwords||[]).length,"/5)"]}),(U.passwords||[]).length<5&&(0,s.jsx)(g.Z,{onClick:function(){return te(!0)},children:(0,s.jsx)(A.Z,{})})]}),(0,s.jsx)(b.Z,{children:(U.passwords||[]).map((function(n,r){return(0,s.jsxs)(j.Z,{className:e.vaultItem,children:[(0,s.jsx)(y.Z,{primary:n.name,secondary:"Password: ".concat(n.password)}),(0,s.jsx)(g.Z,{onClick:function(){return be(n.password)},children:(0,s.jsx)(_.Z,{})}),(0,s.jsx)(g.Z,{onClick:function(){return function(e){var n=(U.passwords||[])[e];oe(e),ce(n.name),de(n.password),he(!0)}(r)},children:(0,s.jsx)(N.Z,{})}),(0,s.jsx)(g.Z,{onClick:function(){return we(r)},children:(0,s.jsx)(O.Z,{})})]},r)}))})]}),(0,s.jsxs)(Z.Z,{open:re,onClose:function(){return te(!1)},children:[(0,s.jsx)(k.Z,{children:"Add New Password"}),(0,s.jsxs)(C.Z,{children:[(0,s.jsx)(w.Z,{label:"Name",value:Q,onChange:function(e){return R(e.target.value)},fullWidth:!0,margin:"normal"}),(0,s.jsx)(w.Z,{label:"Password",type:"password",value:Y,onChange:function(e){return ee(e.target.value)},fullWidth:!0,margin:"normal"})]}),(0,s.jsxs)(S.Z,{children:[(0,s.jsx)(x.Z,{onClick:function(){return te(!1)},children:"Cancel"}),(0,s.jsx)(x.Z,{onClick:xe,color:"primary",children:"Add"})]})]}),(0,s.jsxs)(Z.Z,{open:me,onClose:function(){return he(!1)},children:[(0,s.jsx)(k.Z,{children:"Edit Password"}),(0,s.jsxs)(C.Z,{children:[(0,s.jsx)(w.Z,{label:"Name",value:ue,onChange:function(e){return ce(e.target.value)},fullWidth:!0,margin:"normal"}),(0,s.jsx)(w.Z,{label:"Password",type:"password",value:pe,onChange:function(e){return de(e.target.value)},fullWidth:!0,margin:"normal"})]}),(0,s.jsxs)(S.Z,{children:[(0,s.jsx)(x.Z,{onClick:function(){return he(!1)},children:"Cancel"}),(0,s.jsx)(x.Z,{onClick:ge,color:"primary",children:"Update"})]})]})]}):null}},20:function(e,n,r){"use strict";r.d(n,{I:function(){return a},db:function(){return s},t:function(){return o}});var t,a,s,o,i=r(3977),u=r(9828),c=r(5876),l=r(6689),p={apiKey:"AIzaSyCks5vci6I6vzi1uiaBW-BPkFltXCSwOMU",authDomain:"qrencryptor.firebaseapp.com",projectId:"qrencryptor",storageBucket:"qrencryptor.firebasestorage.app",messagingSenderId:"979193624185",appId:"1:979193624185:web:ba20f034adf35f2a1646a8",measurementId:"G-SWZ1TZSVVM"};console.log("Firebase Config:",p),console.log("Initializing Firebase app"),0===(0,i.C6)().length?(console.log("Creating new app"),t=(0,i.ZF)(p)):(console.log("App already exists"),t=(0,i.C6)()[0]),a=(0,c.v0)(t),s=(0,u.ad)(t),o=(0,l.cF)(t),console.log("db initialized:",s)}},function(e){e.O(0,[703,281,414,545,157,602,774,888,179],(function(){return n=9344,e(e.s=n);var n}));var n=e.O();_N_E=n}]);